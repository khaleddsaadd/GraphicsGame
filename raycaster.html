<!-- My scene -->
	<canvas id="scene"></canvas>


<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.min.js"></script>
<script>
//Get the height and the width of the window
var ww = window.innerWidth,
	wh = window.innerHeight;

function init(){

	/* WEBGL RENDERER */
	renderer = new THREE.WebGLRenderer({canvas : document.getElementById('scene')});
	renderer.setClearColor(0x3F3F3F);
	renderer.setSize(ww,wh);

	/* SCENE */
	scene = new THREE.Scene();

	/* CAMERA */
	camera = new THREE.PerspectiveCamera(50, ww/wh, 1, 10000 );
	camera.position.set(0, 250, 700);
	camera.lookAt(new THREE.Vector3(0,0,0));
	scene.add(camera);


	/* LIGHT */
	light = new THREE.DirectionalLight(0xffffff, 1);
	light.position.set( 0, 500, 100 );
	scene.add(light);

	createBox();

	renderer.render(scene,camera);

	//If the user clicks
	window.addEventListener("click", click);

};

function createBox(){

	//3d object that contains all my cubes
	cubes = new THREE.Object3D();

	geometry = new THREE.BoxGeometry(50,50,50);
	texture = new THREE.MeshLambertMaterial({color:0x00ff00 });

	//Generate 70 random cubes
	for(var i=0;i<5;i++){
		cube = new THREE.Mesh(geometry, texture);
		//Set random positions
	/*	cube.rotation.x = (Math.random()-.5)*Math.PI;
		cube.rotation.y = (Math.random()-.5)*Math.PI;
		cube.rotation.z = (Math.random()-.5)*Math.PI;*/

		cube.position.x = (Math.random()-.5)*wh;
		cube.position.y = (Math.random()-.5)*ww;
		cube.position.z = (Math.random()-.5)*500;

		//Add the new cube in the 3D object
		cubes.add(cube);
	}

	//Add my cubes in my scene
	scene.add(cubes);

};

function click(e){
	//We create a 2D vector
	vector = new THREE.Vector2();
	//We set its position where the user clicked and we convert it to a number between -1 & 1
	vector.set(
		2 * (e.clientX / ww) - 1,
		1 - 2 * (e.clientY / wh )
	);

	//We create a raycaster, which is some kind of laser going through your scene
	raycaster = new THREE.Raycaster();
	//We apply two parameters to the 'laser', its origin (where the user clicked) and the direction (what the camera 'sees')
	raycaster.setFromCamera(vector,camera);

	//We get all the objects the 'laser' find on its way (it returns an array containing the objects)
	intersects = raycaster.intersectObjects(cubes.children);

	//If detect that we have at least 1 object
	//The first object in the array is the closest to the camera
	if(intersects.length > 0 ){
		//We apply a random color to the first object
		intersects[0].object.material = new THREE.MeshLambertMaterial({ color : new THREE.Color(parseInt(Math.random()*16777216)) } );

		//We render our scene
		renderer.render(scene,camera);
	}
};


//Init our scene
init();

</script>